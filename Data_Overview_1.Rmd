---
title: "Econometrics_5300_Data_Anlalysis"
author: "Andrew Zinkan"
date: "8/1/2022"
output: 
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## RESEARCH QUESTION:

The College Scorecard was released at the start of September 2015. Among colleges that predominantly grant bachelor’s degrees, did the release of the Scorecard shift student interest to high-earnings colleges relative to low-earnings ones (as proxied by Google searches for keywords associated with those colleges)?

REQ
- You will need to produce at least one regression and one graph for your analysis, and explain them.


```{r, results= "hide", message=FALSE, warning=FALSE}
# Load initial packages
library(tidyverse)
library(ggplot2)
library(dplyr)
library(vtable)
library(fixest)
```
# Notes about the data:

- There are multiple keywords per university, and the number of keywords is not the same across universities
- Google Trends shows the popularity of a given search term in Google over time.
- Google Trends indices are comparable only to themselves. That is, if the term “boston university” increases from 15 to 16 from one
week to the next, and the term “seattle university” also went from 15 to 16, then we know that they both increased, but we don’t know if the amount of increase was the same (even though they both increased by 1, that “1” could mean different amounts of searching for Boston U and Seattle U), or that they’re currently both getting the same amount of attention (even though they both end up with 16, that could mean wildly different amounts of searches for Boston and for Seattle). You can make the indices reasonably comparable by standardizing them (for each term, subtract the mean and divide by the standard deviation).
There are multiple universities that share the same schname, which will mess up your ability to link Scorecard data to Google Trends data but for this assignment I will allow you to just drop all universities that share an exact name with another university.


### Load Raw Data
```{r, results= "hide", message=FALSE, warning=FALSE}
# Striping the Nulls to NA Values
DataDictRaw <-  read.csv("Data_Exploration/CollegeScorecardDataDictionary.csv", na.strings = c("","NA","NULL",NULL))
IDNameLinkRaw <- read.csv("Data_Exploration/id_name_link.csv", na.strings = c("","NA","NULL",NULL))
MostRecentRaw <- read.csv("Data_Exploration/Most_Recent_Cohorts_Scorecard_Elements.csv", na.strings = c("","NA","NULL",NULL))
TrendsUpToFinishRaw <- read.csv("Data_Exploration/trends_up_to_finish.csv", na.strings = c("","NA","NULL",NULL))
TrendsUpToInter_1_Raw <- read.csv("Data_Exploration/trends_up_to_inter_1.csv", na.strings = c("","NA","NULL",NULL))
TrendsUpToInter_2_Raw <- read.csv("Data_Exploration/trends_up_to_inter_2.csv", na.strings = c("","NA","NULL",NULL))
TrendsUpToInter_3_Raw <- read.csv("Data_Exploration/trends_up_to_inter_3.csv", na.strings = c("","NA","NULL",NULL))
TrendsUpToInter_4_Raw <- read.csv("Data_Exploration/trends_up_to_inter_4.csv", na.strings = c("","NA","NULL",NULL))
TrendsUpToInter_5_Raw <- read.csv("Data_Exploration/trends_up_to_inter_5.csv", na.strings = c("","NA","NULL",NULL))
TrendsUpToInter_6_Raw <- read.csv("Data_Exploration/trends_up_to_inter_6.csv", na.strings = c("","NA","NULL",NULL))
TrendsUpToUmRaw <- read.csv("Data_Exploration/trends_up_to_UM.csv", na.strings = c("","NA","NULL",NULL))
TrendsUpToUphoenixRaw <- read.csv("Data_Exploration/trends_up_to_UPhoenix.csv", na.strings = c("","NA","NULL",NULL))
TrendsUpToUtRaw <- read.csv("Data_Exploration/trends_up_to_UT.csv", na.strings = c("","NA","NULL",NULL))
TrendsUpToUtmbRaw <- read.csv("Data_Exploration/trends_up_to_UTMB.csv", na.strings = c("","NA","NULL",NULL))
TrendsUpToYorktowneRaw <- read.csv("Data_Exploration/trends_up_to_Yorktowne.csv", na.strings = c("","NA","NULL",NULL))
```

## Overview of Data

```{r, results= "hide", message=FALSE, warning=FALSE}
summary(DataDictRaw)
```
Notable Observations

- 1295 unique different variables
- Full Data Dict Available In Apedex()

``` {r}
summary(IDNameLinkRaw)

```
Data set holds unique ids for the universities searched which can be used to match colleges as identified in the Scorecard data (by unitid and opeid / UNITID and OPEID) with colleges as identified in the Google Trends data (by schname)

- opeid: 8-digit OPE ID for institution
- unitid: Unit ID for institution
- schname: the search school name

``` {r, results= "hide", message=FALSE, warning=FALSE}
IDNameLinkRaw %>% 
  group_by(opeid) %>%
  summarise(count_unique = n_distinct(opeid)) %>% 
  arrange(., desc(count_unique))
```
Primary Key: both opeid & unitid are primary keys

```{r, results= "hide", message=FALSE, warning=FALSE}
summary(MostRecentRaw)

```
Data set holds 122 unique variables which are directly associated with out primary key combination
- opeid: 8-digit OPE ID for institution
- unitid: Unit ID for institution

This is data from the College Scorecard, a simple dataset that contains lots of information about United States colleges and the students that graduate from them.

Holds a variety of information about the school such as:

- school type
- location
- size
- admission rate
- standard entry test score distributions
- degree ypes awarded
- race 
- price
- etc..

Primary Key: both opeid & unitid are primary keys

``` {r, results= "hide", message=FALSE, warning=FALSE}
summary(TrendsUpToFinishRaw)

```

```{r}
head(TrendsUpToFinishRaw)
```
Data set holds panel data for each university and key word index rating over time.
Index ranged from 1-100 (this is relative to the school) indexes are not comparable directly

Primary Key: schid & keynum & monthorweek

** NOTE: Schid is not a unique value across similar panel data sets


``` {r, message=FALSE, warning=FALSE}
summary(TrendsUpToInter_1_Raw)
summary(TrendsUpToUphoenixRaw)

```
``` {r}

head(TrendsUpToInter_1_Raw)
head(TrendsUpToUphoenixRaw)


```
TrendsUpToInter_1_Raw - 6 are identical sets buts account for different schools.
These tables are also the same structure but represent different school sets

- TrendsUpToUmRaw
- TrendsUpToUphoenixRaw
- TrendsUpToUtRaw
- TrendsUpToUtmbRaw
- TrendsUpToYorktowneRaw
- unioned Data sets 1-6 would make full set of TrendsUpToInter Data

Data set holds panel data for each university and key word index rating over time.
index ranged from 1-100 (this is relative to the school) indexes are not comparable directly

`trends_up_to_....csv`: These are files generated using Google Trends. They are the Google Trends index for each keyword for the given monthorweek. Each keyword (indexed with keynum) is selected to be reflective of a university in the United States, given by schname. There are multiple files because the Google Trends API will kick you off if you make too many requests, and you have to start again.

Primary Key: schid & keynum & monthorweek

## List of Interesting variables
Variables available for this data set are broken up by the following variables types:
```{r, echo = FALSE}
DataDictRaw %>% 
  select(dev.category) %>% 
  group_by(dev.category) %>% 
  summarise()

```
### Academic Variables:

```{r, echo = FALSE }
DataDictRaw %>% 
  select(NAME.OF.DATA.ELEMENT, VARIABLE.NAME) %>% 
  filter(DataDictRaw$dev.category == 'academics')
  
```
### Admission Variables:

```{r, echo = FALSE}
DataDictRaw %>% 
  select(NAME.OF.DATA.ELEMENT, VARIABLE.NAME) %>% 
  filter(DataDictRaw$dev.category == 'admissions')
  
```
### Aid Variables:

```{r, echo = FALSE}
DataDictRaw %>% 
  select(NAME.OF.DATA.ELEMENT, VARIABLE.NAME) %>% 
  filter(DataDictRaw$dev.category == 'aid')
  
```
### Completion Variables:

```{r, echo = FALSE}
DataDictRaw %>% 
  select(NAME.OF.DATA.ELEMENT, VARIABLE.NAME) %>% 
  filter(DataDictRaw$dev.category == 'completion')
  
```

### Cost Variables:

```{r, echo = FALSE }
DataDictRaw %>% 
  select(NAME.OF.DATA.ELEMENT, VARIABLE.NAME) %>% 
  filter(DataDictRaw$dev.category == 'cost')
  
```

### Earning Variables:

```{r, echo = FALSE}
DataDictRaw %>% 
  select(NAME.OF.DATA.ELEMENT, VARIABLE.NAME) %>% 
  filter(DataDictRaw$dev.category == 'earnings')
  
```

### Repayment Variables:

```{r, echo = FALSE}
DataDictRaw %>% 
  select(NAME.OF.DATA.ELEMENT, VARIABLE.NAME) %>% 
  filter(DataDictRaw$dev.category == 'repayment')

  
```

### School Variables:

```{r, echo = FALSE}
DataDictRaw %>% 
  select(NAME.OF.DATA.ELEMENT, VARIABLE.NAME) %>% 
  filter(DataDictRaw$dev.category == 'school')
  
```
### Student Variables:

```{r, echo = FALSE}
DataDictRaw %>% 
  select(NAME.OF.DATA.ELEMENT, VARIABLE.NAME) %>% 
  filter(DataDictRaw$dev.category == 'student')
  
```

### Missing Data
```{r, echo = FALSE}
# Finding % of nulls
MostRecentNA <- map(MostRecentRaw, ~mean(is.na(.)))

```
### Variables of interest:

percentage Of degrees Awarded: PCIP{1-54}
bachelors degrees by subject: CIP26BACHL, CIP25BACHL etc.
Admissions Rates Variables/ SAT/ & ACT scores
Google Search volums

commit: b9ff0343

